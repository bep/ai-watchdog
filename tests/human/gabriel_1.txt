diff --git a/.vscode/launch.json b/.vscode/launch.json
deleted file mode 100644
index dc7c8bd..0000000
--- a/.vscode/launch.json
+++ /dev/null
@@ -1,16 +0,0 @@
-{
-    // Use IntelliSense to learn about possible attributes.
-    // Hover to view descriptions of existing attributes.
-    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
-    "version": "0.2.0",
-    "configurations": [
-        {
-            "name": "Python: Arquivo Atual",
-            "type": "python",
-            "request": "launch",
-            "program": "${file}",
-            "console": "integratedTerminal",
-            "args": ["<", "arestas.in"]
-        }
-    ]
-}
\ No newline at end of file
diff --git a/__pycache__/chew.cpython-38.pyc b/__pycache__/chew.cpython-38.pyc
deleted file mode 100644
index 3a4db8c..0000000
Binary files a/__pycache__/chew.cpython-38.pyc and /dev/null differ
diff --git a/__pycache__/convex.cpython-38.pyc b/__pycache__/convex.cpython-38.pyc
index e6bfc45..941e1bc 100644
Binary files a/__pycache__/convex.cpython-38.pyc and b/__pycache__/convex.cpython-38.pyc differ
diff --git a/__pycache__/convex.cpython-39.pyc b/__pycache__/convex.cpython-39.pyc
deleted file mode 100644
index 134859a..0000000
Binary files a/__pycache__/convex.cpython-39.pyc and /dev/null differ
diff --git a/__pycache__/corner_table.cpython-38.pyc b/__pycache__/corner_table.cpython-38.pyc
index 0575545..c778e82 100644
Binary files a/__pycache__/corner_table.cpython-38.pyc and b/__pycache__/corner_table.cpython-38.pyc differ
diff --git a/__pycache__/corner_table.cpython-39.pyc b/__pycache__/corner_table.cpython-39.pyc
deleted file mode 100644
index 1cfa55c..0000000
Binary files a/__pycache__/corner_table.cpython-39.pyc and /dev/null differ
diff --git a/__pycache__/delaunay.cpython-38.pyc b/__pycache__/delaunay.cpython-38.pyc
index 350b3f7..5b3712f 100644
Binary files a/__pycache__/delaunay.cpython-38.pyc and b/__pycache__/delaunay.cpython-38.pyc differ
diff --git a/__pycache__/delaunay.cpython-39.pyc b/__pycache__/delaunay.cpython-39.pyc
deleted file mode 100644
index a089e00..0000000
Binary files a/__pycache__/delaunay.cpython-39.pyc and /dev/null differ
diff --git a/__pycache__/intersect_edges.cpython-38.pyc b/__pycache__/intersect_edges.cpython-38.pyc
index 358b711..02aaf1a 100644
Binary files a/__pycache__/intersect_edges.cpython-38.pyc and b/__pycache__/intersect_edges.cpython-38.pyc differ
diff --git a/__pycache__/intersect_edges.cpython-39.pyc b/__pycache__/intersect_edges.cpython-39.pyc
deleted file mode 100644
index cd6ed0a..0000000
Binary files a/__pycache__/intersect_edges.cpython-39.pyc and /dev/null differ
diff --git a/__pycache__/obj.cpython-38.pyc b/__pycache__/obj.cpython-38.pyc
index c2a9d8a..53c85a7 100644
Binary files a/__pycache__/obj.cpython-38.pyc and b/__pycache__/obj.cpython-38.pyc differ
diff --git a/__pycache__/obj.cpython-39.pyc b/__pycache__/obj.cpython-39.pyc
deleted file mode 100644
index 42a7df2..0000000
Binary files a/__pycache__/obj.cpython-39.pyc and /dev/null differ
diff --git a/arestas.in b/arestas.in
index 3fc3f60..040282f 100644
--- a/arestas.in
+++ b/arestas.in
@@ -1,2 +1,2 @@
 19,22,22,18,18,16,16,14,14,10,10,4,4,5,5,6,6,19
-0.06306657711498222
+0.04306657711498222
diff --git a/chew.py b/chew.py
index 3a42127..20f9ee5 100644
--- a/chew.py
+++ b/chew.py
@@ -75,18 +75,25 @@ def border(aresta, faces, verts, corners):
                     return True, [pi,pj,pk]
     return False, [pi,pj,pk]
 
-def user_defined(arestas_restritas, h, faces, verts, corners):
+def user_defined(arestas_restritas, h, faces, verts, corners, ax):
     #TODO limitar o tamanho das arestas de borda entre h e raiz de 3h
     # edges = delaunay.find_edges(faces)
     # edges_length = [length(x) for x in [np.asarray(verts[y[0]-1]) - verts[y[1]-1] for y in edges]]
     # h = min(edges_length)
+    fila = queue.Queue()
+
     for aresta in arestas_restritas:
+        fila.put(aresta)
+    
+    while not fila.empty():
+        plot_tri(faces.copy(), verts.copy(), ax)
+        aresta = fila.get()
         bord, tri = border(aresta, faces, verts, corners)
         if bord:
-            if length(np.asarray(verts[aresta[0]-1])- verts[aresta[1]-1]) > h:
+            if length(np.asarray(verts[aresta[0]-1])- verts[aresta[1]-1]) > np.sqrt(3)*h:
                 arestas_restritas.remove(aresta)
                 meio = np.asarray(verts[aresta[1]-1]) + (np.asarray(verts[aresta[0]-1])- np.asarray(verts[aresta[1]-1]))/2
-                verts.append(meio)
+                verts.append(list(meio))
 
                 faces.pop(delaunay.find_tri_index(tri,faces))
                 faces.append([aresta[0], tri[2], len(verts)])
@@ -95,7 +102,9 @@ def user_defined(arestas_restritas, h, faces, verts, corners):
                 corners = corner_table.build_corner_table(faces)
 
                 arestas_restritas.append([aresta[0],len(verts)])
+                fila.put([aresta[0],len(verts)])
                 arestas_restritas.append([len(verts),aresta[1]])
+                fila.put([len(verts),aresta[1]])
 
     return corners
 
@@ -105,7 +114,7 @@ def circumcenter(a, b, c):
     uy = ((a[0] * a[0] + a[1] * a[1]) * (c[0] - b[0]) + (b[0] * b[0] + b[1] * b[1]) * (a[0] - c[0]) + (c[0] * c[0] + c[1] * c[1]) * (b[0] - a[0])) / d
     return (ux, uy, 0)
 
-def inside_triangulation(pr, tri, faces, verts, corners, ax):
+def inside_triangulation(pr, tri, faces, verts, corners, ax, h, arestas_restritas):
     a = verts[tri.tri[0]-1]
     b = verts[tri.tri[1]-1]
     c = verts[tri.tri[2]-1]
@@ -118,14 +127,16 @@ def inside_triangulation(pr, tri, faces, verts, corners, ax):
             break
 
     #TODO verificar se tamanho da aresta esta entre h e (raiz de 3)*h, se estiver maior divide, se tiver no range ignora
+    if (np.asarray([length(np.asarray(b) - np.asarray(a)), length(np.asarray(c) - np.asarray(b)), length(np.asarray(a) - np.asarray(c))]) < np.sqrt(3)*h).all():
+        return False, pr
+
+    distAB = length(np.asarray(a) + ((np.asarray(b) - np.asarray(a))/2) - np.asarray(pr))
+    distBC = length(np.asarray(b) + ((np.asarray(c) - np.asarray(b))/2) - np.asarray(pr))
+    distCA = length(np.asarray(c) + ((np.asarray(a) - np.asarray(c))/2) - np.asarray(pr))
     if not delaunay.inside(pr, verts, corners, faces)[0]:
         if not border: # se circuncentro não é visível
             return False, pr
         else:
-            distAB = length(np.asarray(a) + ((np.asarray(b) - np.asarray(a))/2) - np.asarray(pr))
-            distBC = length(np.asarray(b) + ((np.asarray(c) - np.asarray(b))/2) - np.asarray(pr))
-            distCA = length(np.asarray(c) + ((np.asarray(a) - np.asarray(c))/2) - np.asarray(pr))
-
             if distAB < distBC:
                 if distAB < distCA:
                     #AB é menor retorna o ponto médio
@@ -139,30 +150,52 @@ def inside_triangulation(pr, tri, faces, verts, corners, ax):
             else:
                 #CA é menor retorna o ponto médio
                 return True, np.asarray(c) + ((np.asarray(a) - np.asarray(c))/2)
-    return True, pr
+    else:
+        if distAB < distBC:
+            if distAB < distCA:
+                #AB é menor retorna o ponto médio
+                verts.append(list(np.asarray(a) + ((np.asarray(b) - np.asarray(a))/2)))
+            else:
+                #CA é menor retorna o ponto médio
+                verts.append(list(np.asarray(c) + ((np.asarray(a) - np.asarray(c))/2)))
+        elif distBC < distCA:
+            #BC é menor retorna o ponto médio
+            verts.append(list(np.asarray(b) + ((np.asarray(c) - np.asarray(b))/2)))
+        else:
+            #CA é menor retorna o ponto médio
+            verts.append(list(np.asarray(c) + ((np.asarray(a) - np.asarray(c))/2)))
+        #achar arestas que intersectam
+        verts.append(list(pr))
+        inter_edges = delaunay.find_intersecting_edges([len(verts)-1,len(verts)], arestas_restritas, verts)
+        verts.remove(list(pr))
+        verts.pop(-1)
+        if len(inter_edges) != 0:
+            return False, pr
+        return True, pr
 
 def chew(faces, corners, verts, ax1, arestas_restritas, h):    
     q = queue.PriorityQueue()
-    
-    corners = user_defined(arestas_restritas, h, faces, verts, corners)
+
+    corners = user_defined(arestas_restritas, h, faces, verts, corners, ax1)
     for tri in faces:
         if not met_req(tri, faces, verts, arestas_restritas, h):
             q.put(PrioritizedTri(faces.index(tri)+1, tri, verts))
-
+    plt.pause(0.05)
     while not q.empty():
         plot_tri(faces.copy(), verts.copy(), ax1)
         tri = q.get()
         if tri.tri not in faces:
             continue
-        if met_req(tri,faces,verts,arestas_restritas,h):
+        if met_req(tri.tri,faces,verts,arestas_restritas,h):
             continue
-        
+        if tri.tri == [13,15,32]:
+            print('a')
         pr = circumcenter(verts[tri.tri[0]-1], verts[tri.tri[1]-1], verts[tri.tri[2]-1])
 
         ax1.scatter(pr[0], pr[1], color='b')
         plt.pause(0.05)
 
-        should_add_point, pr = inside_triangulation(pr, tri, faces.copy(), verts, corners, ax1)
+        should_add_point, pr = inside_triangulation(pr, tri, faces.copy(), verts, corners, ax1, h, arestas_restritas)
         
         if not should_add_point:
             continue
@@ -183,7 +216,8 @@ def chew(faces, corners, verts, ax1, arestas_restritas, h):
             if not met_req(t,faces, verts, arestas_restritas, h):
                 q.put(PrioritizedTri(faces.index(t)+1, t, verts))
         # ax1.triplot(np.asarray(verts)[:,0], np.asarray(verts)[:,1], triangles = np.asarray(T[-3:])-1, color='r')
-            
+    plot_tri(faces.copy(), verts.copy(), ax1)
+    plt.pause(0.05)
     return faces, corners, verts
 
 def plot_tri(faces, vertex, ax):
diff --git a/delaunay.py b/delaunay.py
index b409a6b..592f944 100644
--- a/delaunay.py
+++ b/delaunay.py
@@ -16,6 +16,9 @@ def length(v):
 def find_tri_corners(idx, corners):
     return [corners[3*idx], corners[corners[3*idx].c_n - 1], corners[corners[3*idx].c_p - 1]]
 
+def near_zero(x, eps):
+    return np.asarray([y if abs(y) > eps else 0 for y in x])
+
 def inside(pr, verts, corners, T, tri=None):
     if tri != None:
         T = tri
@@ -28,6 +31,7 @@ def inside(pr, verts, corners, T, tri=None):
         b = [1, pr[0], pr[1]]
 
         x = np.linalg.solve(A,b)
+        x = near_zero(x, 10e-5)
         #TODO pode ter problema aqui
         if (x < 0).any():
             continue
